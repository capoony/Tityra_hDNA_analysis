# *Tityra leucura* Sequencing Data Analysis Pipeline

This pipeline provides an end-to-end workflow for analysing the hDNA properties of the *Tityra leucura* sequencing data, from raw data to taxonomic classification and DNA damage analysis. Below is a summary of each step and guidance on interpreting the results.

## Running the Pipeline

The complete pipeline is implemented in: `shell/main.sh`

To run the entire pipeline:

```bash
bash Tityra/shell/main.sh
```

## Pipeline Steps

1. **Copy Raw Data**
   - Raw sequencing files are copied from the central data repository to the project directory for processing.

2. **Read Trimming (fastp)**
   - Reads are quality- and adapter-trimmed using `fastp`.
   - Outputs: trimmed paired-end reads, merged reads, and quality reports (HTML/JSON).
   - Interpretation: High-quality, adapter-free reads are essential for accurate downstream analysis. Review the HTML report for quality metrics and adapter content.

   ![fastp Quality Report](data/trimmed/Tityra_leucura.html)

3. **ECMSD Pipeline**
   - The ECMSD pipeline is run on the trimmed and merged reads to perform metagenomic binning and filtering.
   - Outputs: Binned and filtered reads, summary statistics.
   - Interpretation: The results directory contains information on the number and quality of bins, and summary statistics for each bin. Check for expected bin sizes and taxonomic assignments.

4. **Kraken2 Taxonomic Classification**
   - Both paired and merged reads are classified using Kraken2 against a comprehensive database.
   - Outputs: Classification reports for paired and merged reads, and a summary CSV.
   - Interpretation: The summary CSV provides an overview of the taxonomic composition of the sample. High proportions of target taxa indicate successful sequencing and classification. Unexpected taxa may indicate contamination or novel findings.

   ![Kraken2 Summary](results/kraken2/kraken_summary.csv)

5. **mapDamage Analysis**
   - Reads are aligned to the reference genome using minimap2 and samtools, then analyzed with mapDamage to assess DNA damage patterns.
   - Outputs: BAM files, mapDamage plots (PDF/PNG).
   - Interpretation: mapDamage plots visualize nucleotide misincorporation and fragmentation patterns typical of ancient or degraded DNA. Look for characteristic damage patterns (e.g., C→T and G→A substitutions at read ends) to assess DNA authenticity and preservation.

   ![mapDamage Fragment Length Distribution](results/mapDamage/Tityra_leucura/Fragmisincorporation_plot.png)

## Final Notes

- All intermediate and final results are organized in the `results/` directory by analysis type.
- Review quality and summary reports at each step to ensure data integrity and successful processing.
- For troubleshooting or further analysis, refer to the log files and HTML/JSON reports generated by each tool.

---

*Pipeline maintained by [Your Name]. For questions or issues, please contact the maintainer.*
